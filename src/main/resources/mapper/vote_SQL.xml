<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="vote">
    <!-- user -->
    <select id="selectUser" parameterType="user" resultType="user">
        <![CDATA[
            SELECT
            	no,
               	id,
               	name,
               	password
            FROM
                user
            WHERE
            	id = #{id}
        ]]>
    </select>
    
    <insert id="insertCommonUser" parameterType="user">
    	<![CDATA[
    		INSERT INTO
    			user
    		(
    			id,
    			name,
    			password
    		)
    		VALUES
    		(
    			#{id},
    			#{name},
    			#{password}
    		)
    	]]>
    </insert>
    
    <!-- article -->
    <select id="selectOneArticle" parameterType="int" resultType="article">
    	<![CDATA[
    		SELECT
    			article.no no,
    			article.title title,
    			article.content content,
    			article.hit_count hitCount,
    			article.create_date createDate,
    			user.name username
    		FROM
    			article, user
    		WHERE
    			article.no = #{articleNo} and article.user_no = user.no
    	]]>
    </select>
    
    <select id="selectListOfArticles" resultType="article">
    	<![CDATA[
	    	SELECT
    			article.no no,
    			article.title title,
    			article.hit_count hitCount,
    			article.create_date createDate,
    			user.name username
    		FROM
    			article, user
    		WHERE
    			article.user_no = user.no
    		ORDER BY create_date DESC
    	]]>
    </select>
    
    <select id="selectListOfMyArticles" parameterType="int" resultType="article">
    	<![CDATA[
	    	SELECT
    			article.no no,
    			article.title title,
    			article.hit_count hitCount,
    			article.create_date createDate
    		FROM
    			article, user
    		WHERE
    			user.no = #{userNo} and
    			article.user_no = user.no
    		ORDER BY create_date DESC
    	]]>
    </select>
    
    <insert id="insertOneArticle" parameterType="article">
    	<![CDATA[
    		
    	]]>
    </insert>
    
    <!-- comment -->
    
    <select id="selectCommentsForArticle" parameterType="int" resultType="comment">
    	<![CDATA[
    		select 
    			user.name username,
    			comment.context context, 
    			comment.update_date updateDate
    		from
    			comment, 
    			user 
    		where
    			article_no = #{articleNo} and 
    			user.no = comment.user_no
    		order by create_date ASC
    	]]>
    </select> 
</mapper>